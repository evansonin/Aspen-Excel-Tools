<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!-- This file shows how to design a first-run page that provides a welcome screen to the user about the features of the add-in. -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Contoso Task Pane Add-in</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <!-- For more information on Fluent UI, visit https://developer.microsoft.com/fluentui#/. -->
    <!-- <link rel="stylesheet" href="https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css"/> -->

    <!-- Template styles -->
    <link href="taskpane2.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <div class="info" hidden>
      <p><strong>Hello:</strong></p>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc mollis dictum massa. Sed dapibus lorem et nisi pharetra, ut dignissim velit placerat. Proin dui augue, lacinia et pellentesque eu, posuere eu ipsum.</p>
    </div>
    <form id="interviewForm">
        <div class="accordion-container">
            <button type="button" class="accordion-header">BOK Spreadsheet Tool</button>
            <div class="accordion-panel open"> <!-- 'open' class for initial styling, JS will set max-height -->
                <span><i>Hover for more information</i></span>
                <button type="button" title="Open ANB login page to download CSV" id="openAnbSiteButton"> 
                    Step 1: Open Bank Login
                </button>
                <div class="input-group" title="Range for the interview questions">
                    <label for="bok-csv-file-input" >Step 2: Choose the downloaded CSV file</label>
                    <input type="file" title="Select file" placeholder="Select file" accept=".csv" class="ms-TextField-field" id="bok-csv-file-input">
                </div>
                <input type="checkbox" id="bok-markCleared" checked>
<!--                 <div class="checkNumberInputDiv">
                    <label for="lastCheckNumber" title="Previous check number. The program will add 1 to this number for the first transaction">Last Check Number</label>
                    <input type="number" id="lastCheckNumber" class="checkNumberInput" value=1 min=0>
                </div> -->
                <button type="button" class="bok-import-button" id="import-bok-csv-button" title="Import CSV into Excel">
                    Import to Excel
                </button>
                <!-- <div><br><br></div> -->
                <span id="refresh"></span>
            </div>
        </div>
        <div class="accordion-container">
            <button type="button" class="accordion-header">ANB Spreadsheet Tool</button>
            <div class="accordion-panel open"> <!-- 'open' class for initial styling, JS will set max-height -->
                <span><i>Hover for more information</i></span>
                <button type="button" title="Open BOK login page to download CSV" id="openBokSiteButton">
                    Step 1: Open Bank Login
                </button>
                <div class="input-group" title="Range for the interview questions">
                    <label for="bok-csv-file-input" >Step 2: Choose the downloaded CSV file</label>
                    <input type="file" title="Select file" placeholder="Select file" accept=".csv" class="ms-TextField-field" id="anb-csv-file-input">
                </div>
                <input type="checkbox" id="anb-markCleared" checked>
<!--                 <div class="checkNumberInputDiv">
                    <label for="lastCheckNumber" title="Previous check number. The program will add 1 to this number for the first transaction">Last Check Number</label>
                    <input type="number" id="lastCheckNumber" class="checkNumberInput" value=1 min=0>
                </div> -->
                <button type="button" class="bok-import-button" id="import-anb-csv-button" title="Import CSV into Excel">
                    Import to Excel
                </button>
                <div><br><br></div>
                <span id="refresh"></span>
            </div>
        </div>
    </form>
</body>
<script>
    accHeaders = document.getElementsByClassName("accordion-header");
    for (var i = 0; i < accHeaders.length; i++) {
        var header = accHeaders[i];
        var panel = header.nextElementSibling;

        // Initialize accordions based on their 'active' class
        if (header.classList.contains("active")) {
        // If header is active, panel should be open
        if (panel && panel.classList.contains("accordion-panel")) {
            panel.style.maxHeight = panel.scrollHeight + "px";
            panel.classList.add("open"); // Ensure 'open' class for styling (padding transition)
        }
        } else {
        // If header is not active, panel should be closed
        if (panel && panel.classList.contains("accordion-panel")) {
            panel.style.maxHeight = null;
            panel.classList.remove("open");
        }
        }

        header.addEventListener("click", function() {
        this.classList.toggle("active");
        document.getElementById("refresh").innerHTML = "<br><br><br>";
        var clickedPanel = this.nextElementSibling;
        if (clickedPanel.style.maxHeight) { // Panel is open, so close it
            clickedPanel.style.maxHeight = null;
            clickedPanel.classList.remove("open");
        } else { // Panel is closed, so open it
            clickedPanel.style.maxHeight = clickedPanel.scrollHeight + "px";
            clickedPanel.classList.add("open");
        }
        });
    }

</script>
</html>
