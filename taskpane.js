/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={44809:function(e,t){var n,r;n=function e(){var t,n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},r=!n.document&&!!n.postMessage,i=n.IS_PAPA_WORKER||!1,o={},s=0,a={};function c(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=b(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new d(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){var r=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<r){let t=this._config.newline;t||(o=this._config.quoteChar||'"',t=this._handle.guessLineEndings(e,o)),e=[...e.split(t).slice(r)].join(t)}this.isFirstChunk&&_(this._config.beforeFirstChunk)&&void 0!==(o=this._config.beforeFirstChunk(e))&&(e=o),this.isFirstChunk=!1,this._halted=!1,r=this._partialLine+e;var o=(this._partialLine="",this._handle.parse(r,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=o.meta.cursor,this._finished||(this._partialLine=r.substring(e-this._baseIndex),this._baseIndex=e),o&&o.data&&(this._rowCount+=o.data.length),r=this._finished||this._config.preview&&this._rowCount>=this._config.preview,i)n.postMessage({results:o,workerId:a.WORKER_ID,finished:r});else if(_(this._config.chunk)&&!t){if(this._config.chunk(o,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=o=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(o.data),this._completeResults.errors=this._completeResults.errors.concat(o.errors),this._completeResults.meta=o.meta),this._completed||!r||!_(this._config.complete)||o&&o.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),r||o&&o.meta.paused||this._nextChunk(),o}this._halted=!0},this._sendError=function(e){_(this._config.error)?this._config.error(e):i&&this._config.error&&n.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function u(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),c.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),r||(t.onload=k(this._chunkLoaded,this),t.onerror=k(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var e,n=this._config.downloadRequestHeaders;for(e in n)t.setRequestHeader(e,n[e])}var i;this._config.chunkSize&&(i=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+i));try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}r&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(e=>null!==(e=e.getResponseHeader("Content-Range"))?parseInt(e.substring(e.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){e=t.statusText||e,this._sendError(new Error(e))}}function l(e){(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),c.call(this,e);var t,n,r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=k(this._chunkLoaded,this),t.onerror=k(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,i=(this._config.chunkSize&&(i=Math.min(this._start+this._config.chunkSize,this._input.size),e=n.call(e,this._start,i)),t.readAsText(e,this._config.encoding));r||this._chunkLoaded({target:{result:i}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function f(e){var t;c.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){var e,n;if(!this._finished)return e=this._config.chunkSize,t=e?(n=t.substring(0,e),t.substring(e)):(n=t,""),this._finished=!t,this.parseChunk(n)}}function h(e){c.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=k((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=k((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=k((function(){this._streamCleanUp(),r=!0,this._streamData("")}),this),this._streamCleanUp=k((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function d(e){var t,n,r,i,o=Math.pow(2,53),s=-o,c=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,u=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,l=this,f=0,h=0,d=!1,m=!1,v=[],y={data:[],errors:[],meta:{}};function k(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function w(){if(y&&r&&(C("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines&&(y.data=y.data.filter((function(e){return!k(e)}))),E()){if(y)if(Array.isArray(y.data[0])){for(var t=0;E()&&t<y.data.length;t++)y.data[t].forEach(n);y.data.splice(0,1)}else y.data.forEach(n);function n(t,n){_(e.transformHeader)&&(t=e.transformHeader(t,n)),v.push(t)}}function i(t,n){for(var r=e.header?{}:[],i=0;i<t.length;i++){var a=i,l=t[i];l=((t,n)=>(t=>(e.dynamicTypingFunction&&void 0===e.dynamicTyping[t]&&(e.dynamicTyping[t]=e.dynamicTypingFunction(t)),!0===(e.dynamicTyping[t]||e.dynamicTyping)))(t)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&((e=>{if(c.test(e)&&(e=parseFloat(e),s<e&&e<o))return 1})(n)?parseFloat(n):u.test(n)?new Date(n):""===n?null:n):n)(a=e.header?i>=v.length?"__parsed_extra":v[i]:a,l=e.transform?e.transform(l,a):l),"__parsed_extra"===a?(r[a]=r[a]||[],r[a].push(l)):r[a]=l}return e.header&&(i>v.length?C("FieldMismatch","TooManyFields","Too many fields: expected "+v.length+" fields but parsed "+i,h+n):i<v.length&&C("FieldMismatch","TooFewFields","Too few fields: expected "+v.length+" fields but parsed "+i,h+n)),r}var l;y&&(e.header||e.dynamicTyping||e.transform)&&(l=1,!y.data.length||Array.isArray(y.data[0])?(y.data=y.data.map(i),l=y.data.length):y.data=i(y.data,0),e.header&&y.meta&&(y.meta.fields=v),h+=l)}function E(){return e.header&&0===v.length}function C(e,t,n,r){e={type:e,code:t,message:n},void 0!==r&&(e.row=r),y.errors.push(e)}_(e.step)&&(i=e.step,e.step=function(t){y=t,E()?w():(w(),0!==y.data.length&&(f+=t.data.length,e.preview&&f>e.preview?n.abort():(y.data=y.data[0],i(y,l))))}),this.parse=function(i,o,s){var c=e.quoteChar||'"';return e.newline||(e.newline=this.guessLineEndings(i,c)),r=!1,e.delimiter?_(e.delimiter)&&(e.delimiter=e.delimiter(i),y.meta.delimiter=e.delimiter):((c=((t,n,r,i,o)=>{var s,c,u,l;o=o||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var f=0;f<o.length;f++){for(var h,d=o[f],p=0,m=0,v=0,y=(u=void 0,new g({comments:i,delimiter:d,newline:n,preview:10}).parse(t)),b=0;b<y.data.length;b++)r&&k(y.data[b])?v++:(m+=h=y.data[b].length,void 0===u?u=h:0<h&&(p+=Math.abs(h-u),u=h));0<y.data.length&&(m/=y.data.length-v),(void 0===c||p<=c)&&(void 0===l||l<m)&&1.99<m&&(c=p,s=d,l=m)}return{successful:!!(e.delimiter=s),bestDelimiter:s}})(i,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=c.bestDelimiter:(r=!0,e.delimiter=a.DefaultDelimiter),y.meta.delimiter=e.delimiter),c=b(e),e.preview&&e.header&&c.preview++,t=i,n=new g(c),y=n.parse(t,o,s),w(),d?{meta:{paused:!0}}:y||{meta:{paused:!1}}},this.paused=function(){return d},this.pause=function(){d=!0,n.abort(),t=_(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){l.streamer._halted?(d=!1,l.streamer.parseChunk(t,!0)):setTimeout(l.resume,3)},this.aborted=function(){return m},this.abort=function(){m=!0,n.abort(),y.meta.aborted=!0,_(e.complete)&&e.complete(y),t=""},this.guessLineEndings=function(e,t){e=e.substring(0,1048576),t=new RegExp(p(t)+"([^]*?)"+p(t),"gm");var n=(e=e.replace(t,"")).split("\r");if(e=1<(t=e.split("\n")).length&&t[0].length<n[0].length,1===n.length||e)return"\n";for(var r=0,i=0;i<n.length;i++)"\n"===n[i][0]&&r++;return r>=n.length/2?"\r\n":"\r"}}function p(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(e){var t=(e=e||{}).delimiter,n=e.newline,r=e.comments,i=e.step,o=e.preview,s=e.fastMode,c=null,u=!1,l=null==e.quoteChar?'"':e.quoteChar,f=l;if(void 0!==e.escapeChar&&(f=e.escapeChar),("string"!=typeof t||-1<a.BAD_DELIMITERS.indexOf(t))&&(t=","),r===t)throw new Error("Comment character same as delimiter");!0===r?r="#":("string"!=typeof r||-1<a.BAD_DELIMITERS.indexOf(r))&&(r=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var h=0,d=!1;this.parse=function(a,g,m){if("string"!=typeof a)throw new Error("Input must be a string");var v=a.length,y=t.length,b=n.length,k=r.length,w=_(i),E=[],C=[],S=[],O=h=0;if(!a)return M();if(s||!1!==s&&-1===a.indexOf(l)){for(var R=a.split(n),x=0;x<R.length;x++){if(S=R[x],h+=S.length,x!==R.length-1)h+=n.length;else if(m)return M();if(!r||S.substring(0,k)!==r){if(w){if(E=[],L(S.split(t)),N(),d)return M()}else L(S.split(t));if(o&&o<=x)return E=E.slice(0,o),M(!0)}}return M()}for(var I=a.indexOf(t,h),D=a.indexOf(n,h),A=new RegExp(p(f)+p(l),"g"),T=a.indexOf(l,h);;)if(a[h]===l)for(T=h,h++;;){if(-1===(T=a.indexOf(l,T+1)))return m||C.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:E.length,index:h}),B();if(T===v-1)return B(a.substring(h,T).replace(A,l));if(l===f&&a[T+1]===f)T++;else if(l===f||0===T||a[T-1]!==f){-1!==I&&I<T+1&&(I=a.indexOf(t,T+1));var F=j(-1===(D=-1!==D&&D<T+1?a.indexOf(n,T+1):D)?I:Math.min(I,D));if(a.substr(T+1+F,y)===t){S.push(a.substring(h,T).replace(A,l)),a[h=T+1+F+y]!==l&&(T=a.indexOf(l,h)),I=a.indexOf(t,h),D=a.indexOf(n,h);break}if(F=j(D),a.substring(T+1+F,T+1+F+b)===n){if(S.push(a.substring(h,T).replace(A,l)),P(T+1+F+b),I=a.indexOf(t,h),T=a.indexOf(l,h),w&&(N(),d))return M();if(o&&E.length>=o)return M(!0);break}C.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:E.length,index:h}),T++}}else if(r&&0===S.length&&a.substring(h,h+k)===r){if(-1===D)return M();h=D+b,D=a.indexOf(n,h),I=a.indexOf(t,h)}else if(-1!==I&&(I<D||-1===D))S.push(a.substring(h,I)),h=I+y,I=a.indexOf(t,h);else{if(-1===D)break;if(S.push(a.substring(h,D)),P(D+b),w&&(N(),d))return M();if(o&&E.length>=o)return M(!0)}return B();function L(e){E.push(e),O=h}function j(e){return-1!==e&&(e=a.substring(T+1,e))&&""===e.trim()?e.length:0}function B(e){return m||(void 0===e&&(e=a.substring(h)),S.push(e),h=v,L(S),w&&N()),M()}function P(e){h=e,L(S),S=[],D=a.indexOf(n,h)}function M(r){if(e.header&&!g&&E.length&&!u){var i=E[0],o=Object.create(null),s=new Set(i);let t=!1;for(let n=0;n<i.length;n++){let r=i[n];if(o[r=_(e.transformHeader)?e.transformHeader(r,n):r]){let e,a=o[r];for(;e=r+"_"+a,a++,s.has(e););s.add(e),i[n]=e,o[r]++,t=!0,(c=null===c?{}:c)[e]=r}else o[r]=1,i[n]=r;s.add(r)}t&&console.warn("Duplicate headers found and renamed."),u=!0}return{data:E,errors:C,meta:{delimiter:t,linebreak:n,aborted:d,truncated:!!r,cursor:O+(g||0),renamedHeaders:c}}}function N(){i(M()),E=[],C=[]}},this.abort=function(){d=!0},this.getCharIndex=function(){return h}}function m(e){var t=e.data,n=o[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){r=!0,v(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(_(n.userStep)){for(var s=0;s<t.results.data.length&&(n.userStep({data:t.results.data[s],errors:t.results.errors,meta:t.results.meta},i),!r);s++);delete t.results}else _(n.userChunk)&&(n.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!r&&v(t.workerId,t.results)}function v(e,t){var n=o[e];_(n.userComplete)&&n.userComplete(t),n.terminate(),delete o[e]}function y(){throw new Error("Not implemented.")}function b(e){if("object"!=typeof e||null===e)return e;var t,n=Array.isArray(e)?[]:{};for(t in e)n[t]=b(e[t]);return n}function k(e,t){return function(){e.apply(t,arguments)}}function _(e){return"function"==typeof e}return a.parse=function(t,r){var i=(r=r||{}).dynamicTyping||!1;if(_(i)&&(r.dynamicTypingFunction=i,i={}),r.dynamicTyping=i,r.transform=!!_(r.transform)&&r.transform,!r.worker||!a.WORKERS_SUPPORTED)return i=null,a.NODE_STREAM_INPUT,"string"==typeof t?(t=(e=>65279!==e.charCodeAt(0)?e:e.slice(1))(t),i=new(r.download?u:f)(r)):!0===t.readable&&_(t.read)&&_(t.on)?i=new h(r):(n.File&&t instanceof File||t instanceof Object)&&(i=new l(r)),i.stream(t);(i=(()=>{var t;return!!a.WORKERS_SUPPORTED&&(t=(()=>{var t=n.URL||n.webkitURL||null,r=e.toString();return a.BLOB_URL||(a.BLOB_URL=t.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",r,")();"],{type:"text/javascript"})))})(),(t=new n.Worker(t)).onmessage=m,t.id=s++,o[t.id]=t)})()).userStep=r.step,i.userChunk=r.chunk,i.userComplete=r.complete,i.userError=r.error,r.step=_(r.step),r.chunk=_(r.chunk),r.complete=_(r.complete),r.error=_(r.error),delete r.worker,i.postMessage({input:t,config:r,workerId:i.id})},a.unparse=function(e,t){var n=!1,r=!0,i=",",o="\r\n",s='"',c=s+s,u=!1,l=null,f=!1,h=((()=>{if("object"==typeof t){if("string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(i=t.delimiter),"boolean"!=typeof t.quotes&&"function"!=typeof t.quotes&&!Array.isArray(t.quotes)||(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(u=t.skipEmptyLines),"string"==typeof t.newline&&(o=t.newline),"string"==typeof t.quoteChar&&(s=t.quoteChar),"boolean"==typeof t.header&&(r=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");l=t.columns}void 0!==t.escapeChar&&(c=t.escapeChar+s),t.escapeFormulae instanceof RegExp?f=t.escapeFormulae:"boolean"==typeof t.escapeFormulae&&t.escapeFormulae&&(f=/^[=+\-@\t\r].*$/)}})(),new RegExp(p(s),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return d(null,e,u);if("object"==typeof e[0])return d(l||Object.keys(e[0]),e,u)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||l),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),d(e.fields||[],e.data||[],u);throw new Error("Unable to serialize unrecognized input");function d(e,t,n){var s="",a=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),c=!Array.isArray(t[0]);if(a&&r){for(var u=0;u<e.length;u++)0<u&&(s+=i),s+=g(e[u],u);0<t.length&&(s+=o)}for(var l=0;l<t.length;l++){var f=(a?e:t[l]).length,h=!1,d=a?0===Object.keys(t[l]).length:0===t[l].length;if(n&&!a&&(h="greedy"===n?""===t[l].join("").trim():1===t[l].length&&0===t[l][0].length),"greedy"===n&&a){for(var p=[],m=0;m<f;m++){var v=c?e[m]:m;p.push(t[l][v])}h=""===p.join("").trim()}if(!h){for(var y=0;y<f;y++){0<y&&!d&&(s+=i);var b=a&&c?e[y]:y;s+=g(t[l][b],y)}l<t.length-1&&(!n||0<f&&!d)&&(s+=o)}}return s}function g(e,t){var r,o;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(o=!1,f&&"string"==typeof e&&f.test(e)&&(e="'"+e,o=!0),r=e.toString().replace(h,c),(o=o||!0===n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||((e,t)=>{for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1})(r,a.BAD_DELIMITERS)||-1<r.indexOf(i)||" "===r.charAt(0)||" "===r.charAt(r.length-1))?s+r+s:r)}},a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\ufeff",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!r&&!!n.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=g,a.ParserHandle=d,a.NetworkStreamer=u,a.FileStreamer=l,a.StringStreamer=f,a.ReadableStreamStreamer=h,n.jQuery&&((t=n.jQuery).fn.parse=function(e){var r=e.config||{},i=[];return this.each((function(e){if("INPUT"!==t(this).prop("tagName").toUpperCase()||"file"!==t(this).attr("type").toLowerCase()||!n.FileReader||!this.files||0===this.files.length)return!0;for(var o=0;o<this.files.length;o++)i.push({file:this.files[o],inputElem:this,instanceConfig:t.extend({},r)})})),o(),this;function o(){if(0===i.length)_(e.complete)&&e.complete();else{var n,r,o,c=i[0];if(_(e.before)){var u=e.before(c.file,c.inputElem);if("object"==typeof u){if("abort"===u.action)return n=c.file,r=c.inputElem,o=u.reason,void(_(e.error)&&e.error({name:"AbortError"},n,r,o));if("skip"===u.action)return void s();"object"==typeof u.config&&(c.instanceConfig=t.extend(c.instanceConfig,u.config))}else if("skip"===u)return void s()}var l=c.instanceConfig.complete;c.instanceConfig.complete=function(e){_(l)&&l(e,c.file,c.inputElem),s()},a.parse(c.file,c.instanceConfig)}}function s(){i.splice(0,1),o()}}),i&&(n.onmessage=function(e){e=e.data,void 0===a.WORKER_ID&&e&&(a.WORKER_ID=e.workerId),"string"==typeof e.input?n.postMessage({workerId:a.WORKER_ID,results:a.parse(e.input,e.config),finished:!0}):(n.File&&e.input instanceof File||e.input instanceof Object)&&(e=a.parse(e.input,e.config))&&n.postMessage({workerId:a.WORKER_ID,results:e,finished:!0})}),(u.prototype=Object.create(c.prototype)).constructor=u,(l.prototype=Object.create(c.prototype)).constructor=l,(f.prototype=Object.create(f.prototype)).constructor=f,(h.prototype=Object.create(c.prototype)).constructor=h,a},void 0===(r=n.apply(t,[]))||(e.exports=r)},55762:function(e,t,n){"use strict";e.exports=n.p+"49a7e665edf2d1269e47.css"}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=r[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){"use strict";var e=n(44809),t=n.n(e);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",s=n.toStringTag||"@@toStringTag";function a(n,r,i,s){var a=r&&r.prototype instanceof u?r:u,l=Object.create(a.prototype);return o(l,"_invoke",function(n,r,i){var o,s,a,u=0,l=i||[],f=!1,h={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return o=t,s=0,a=e,h.n=n,c}};function d(n,r){for(s=n,a=r,t=0;!f&&u&&!i&&t<l.length;t++){var i,o=l[t],d=h.p,p=o[2];n>3?(i=p===r)&&(a=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=d&&((i=n<2&&d<o[1])?(s=0,h.v=r,h.n=o[1]):d<p&&(i=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,h.n=p,s=0))}if(i||n>1)return c;throw f=!0,r}return function(i,l,p){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,p),s=l,a=p;(t=s<2?e:a)||!f;){o||(s?s<3?(s>1&&(h.n=-1),d(s,a)):h.n=a:h.v=a);try{if(u=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,a)))throw TypeError("iterator result is not an object");if(!t.done)return t;a=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(a=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(f=h.n<0)?a:n.call(r,h))!==c)break}catch(t){o=e,s=1,a=t}finally{u=1}}return{value:t,done:f}}}(n,i,s),!0),l}var c={};function u(){}function l(){}function f(){}t=Object.getPrototypeOf;var h=[][r]?t(t([][r]())):(o(t={},r,(function(){return this})),t),d=f.prototype=u.prototype=Object.create(h);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,o(e,s,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=f,o(d,"constructor",f),o(f,"constructor",l),l.displayName="GeneratorFunction",o(f,s,"GeneratorFunction"),o(d),o(d,s,"Generator"),o(d,r,(function(){return this})),o(d,"toString",(function(){return"[object Generator]"})),(i=function(){return{w:a,m:p}})()}function o(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}o=function(e,t,n,r){if(t)i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var s=function(t,n){o(e,t,(function(e){return this._invoke(t,n,e)}))};s("next",0),s("throw",1),s("return",2)}},o(e,t,n,r)}function s(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){s(o,r,i,a,c,"next",e)}function c(e){s(o,r,i,a,c,"throw",e)}a(void 0)}))}}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return(t=function(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f,h,d,p=null,g=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long"});function m(e){return v.apply(this,arguments)}function v(){return v=a(i().m((function e(t){var n,r,o,s,c,u,l,f,h,d=arguments;return i().w((function(e){for(;;)switch(e.n){case 0:n=d.length>1&&void 0!==d[1]?d[1]:"bok",o=0,s=document.getElementById("bok-markCleared"),c=document.getElementById("anb-markCleared"),e.p=1,l=n,e.n="bok"===l?2:"anb"===l?3:"default"===l?4:5;break;case 2:return u=new Date(t[0][3]),e.a(3,5);case 3:return u=new Date(t[0][1]),e.a(3,5);case 4:throw new Error;case 5:o=(u.getMonth()+1).toString().padStart(2,"0"),r=g.format(u).toString(),e.n=7;break;case 6:e.p=6,f=e.v,w("generic",'Error extracting data from the given CSV. Right click the task pane, click "Inspect", and go to the console for more information. Ensure you are using the respective CSV for the tool used.'),"Invalid time value"==f.message?console.error("Error finding a date in the CSV provided. This program currently searches for a date in cell D2 for BOK and B5 for ANB."):console.error("Error opening the given CSV: ".concat(f.message));case 7:return e.p=7,e.n=8,Excel.run(function(){var e=a(i().m((function e(a){var u,l,f,h,d,p,g,m,v,b,_,E,C,S,O;return i().w((function(e){for(;;)switch(e.n){case 0:return u=a.workbook,l=u.worksheets.getActiveWorksheet(),f=u.worksheets,e.p=1,f.load("items/name"),l.load("name"),e.n=2,a.sync();case 2:if(l.name.trim()==r){e.n=5;break}if(h=[],f.items.forEach((function(e){h.push(e.name)})),!h.includes(r)){e.n=3;break}u.worksheets.getItem(r).activate(),e.n=5;break;case 3:if(d={},h.forEach((function(e){d[e.trim()]=e})),!Object.keys(d).includes(r)){e.n=4;break}u.worksheets.getItem(d[r]).activate(),e.n=5;break;case 4:throw w("missingSheet",void 0,r),new Error("The desired sheet was not found");case 5:return e.n=6,a.sync();case 6:e.n=8;break;case 7:throw e.p=7,S=e.v,new Error(S.message);case 8:return e.p=8,l=u.worksheets.getActiveWorksheet(),e.n=9,a.sync();case 9:return e.n=10,y(7);case 10:return p=e.v,e.n=11,y(7,"D");case 11:if(null!==(g=e.v)){e.n=12;break}throw w("generic","Could not determine the last check number. Column D might be empty or structured unexpectedly."),new Error("Could not find first empty row in Check # column (D).");case 12:if(m=0,console.log("Here 345 ".concat(g)),!(g>7)){e.n=14;break}return(v=l.getCell(g-1,3)).load("values"),e.n=13,a.sync();case 13:v.values&&""!==v.values[0][0]&&!isNaN(Number(v.values[0][0]))?m=parseInt(v.values[0][0]):v.values&&""!==v.values[0][0]&&console.warn("Last check number in cell E".concat(g-1,' ("').concat(v.values[0][0],'") was not a parsable number. Starting new checks from 1.')),e.n=16;break;case 14:return e.n=15,k(r);case 15:b=e.v,console.log(b),b&&(m=b,console.log(m));case 16:for(_=0;_<t.length;_++)"bok"==n?(l.getCell(p+_,0).values=t[_][3],t[_][5]>0?(l.getCell(p+_,4).values=t[_][5],s.checked&&(l.getRangeByIndexes(p+_,0,1,6).format.font.color="#008000")):(l.getCell(p+_,5).values=Math.abs(t[_][5]),s.checked&&(l.getRangeByIndexes(p+_,0,1,6).format.font.color="#FF0000")),t[_][4].endsWith("DEBIT")?l.getCell(p+_,1).values="ACH Debit: ".concat(t[_][12]):t[_][4].endsWith("CREDIT")?l.getCell(p+_,1).values="ACH Deposit: ".concat(t[_][12]):l.getCell(p+_,1).values="".concat(t[_][4],": ").concat(t[_][12]),s.checked?l.getCell(p+_,2).values="X".concat(o):((E=l.getCell(p+_,3)).values=m+(_+1),E.format.horizontalAlignment=Excel.HorizontalAlignment.center,l.getRangeByIndexes(p+_,0,1,6).format.font.color="#000000")):"anb"==n&&(l.getCell(p+_,0).values=t[_][1],t[_][2].startsWith("Square Inc")?t[_][5]?(l.getCell(p+_,1).values="ACH Deposit: Square, BSE Sales",l.getCell(p+_,4).values=t[_][5]):t[_][4]&&(l.getCell(p+_,1).values=t[_][2],l.getCell(p+_,5).values=t[_][4]):(l.getCell(p+_,1).values=t[_][2],t[_][4]?l.getCell(p+_,5).values=t[_][4]:t[_][5]&&(l.getCell(p+_,4).values=t[_][5])),c.checked?(l.getCell(p+_,2).values="X".concat(o),t[_][5]?l.getRangeByIndexes(p+_,0,1,6).format.font.color="#008000":t[_][4]&&(l.getRangeByIndexes(p+_,0,1,6).format.font.color="#FF0000")):((C=l.getCell(p+_,3)).values=m+(_+1),C.format.horizontalAlignment=Excel.HorizontalAlignment.center,l.getRangeByIndexes(p+_,0,1,6).format.font.color="#000000"));return e.n=17,a.sync();case 17:e.n=19;break;case 18:throw e.p=18,O=e.v,new Error(O);case 19:return e.a(2)}}),e,null,[[8,18],[1,7]])})));return function(t){return e.apply(this,arguments)}}());case 8:e.n=10;break;case 9:e.p=9,h=e.v,console.error(h);case 10:return e.a(2)}}),e,null,[[7,9],[1,6]])}))),v.apply(this,arguments)}function y(){return b.apply(this,arguments)}function b(){return b=a(i().m((function e(){var t,n,r,o,s=arguments;return i().w((function(e){for(;;)switch(e.n){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:0,n=s.length>1&&void 0!==s[1]?s[1]:"A",r=s.length>2&&void 0!==s[2]?s[2]:null,e.n=1,Excel.run(function(){var e=a(i().m((function e(o){var s,a,c,u,l,f;return i().w((function(e){for(;;)switch(e.n){case 0:return s=r?o.workbook.worksheets.getItem(r):o.workbook.worksheets.getActiveWorksheet(),a=s.getRange("".concat(n,":").concat(n)),e.p=1,(u=a.getUsedRange(!0).getLastCell()).load("rowIndex"),e.n=2,o.sync();case 2:l=u.rowIndex+1,c=Math.max(t,l),e.n=4;break;case 3:return e.p=3,f=e.v,console.error("Column  ".concat(n," is empty or another error occured: ").concat(f.message)),e.a(2,null);case 4:return e.a(2,c)}}),e,null,[[1,3]])})));return function(t){return e.apply(this,arguments)}}());case 1:return o=e.v,e.a(2,o)}}),e)}))),b.apply(this,arguments)}function k(e){return _.apply(this,arguments)}function _(){return _=a(i().m((function e(t){var n,r,o,s,c,u;return i().w((function(e){for(;;)switch(e.n){case 0:return(n=new Date(t)).setMonth(n.getMonth()-1),o=n.toLocaleDateString("en-US",{month:"long",year:"numeric"}),e.p=1,e.n=2,y(7,"D",o);case 2:r=e.v,console.log("First empty row in previous month's sheet is: ".concat(r)),e.n=4;break;case 3:return e.p=3,c=e.v,console.error("Failed to get first empty row. Assuming check number is 1. Error: ".concat(c)),e.a(2,0);case 4:if(!(r>7)){e.n=8;break}return e.p=5,e.n=6,Excel.run(function(){var e=a(i().m((function e(t){var n,s;return i().w((function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getItem(o),(s=n.getCell(r-1,3)).load("values"),e.n=1,t.sync();case 1:return console.log("Value from cell:",s.values),e.a(2,s.values[0][0])}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:return s=e.v,e.a(2,s);case 7:return e.p=7,u=e.v,console.error("Failed to get check number from previous month: ".concat(u)),e.a(2,0);case 8:return e.a(2,0);case 9:return e.a(2)}}),e,null,[[5,7],[1,3]])}))),_.apply(this,arguments)}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Generic error",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"ok";return new Promise((function(i){var o,s=n||"the specified month",a="?type=".concat(encodeURIComponent(e),"&text=").concat(encodeURIComponent(t),"&month=").concat(encodeURIComponent(s),"&button=").concat(r),c="".concat(d,"errorDialog.html").concat(a);Office.context.ui.displayDialogAsync(c,{height:25,width:25,displayInIframe:!0},(function(e){if(e.status===Office.AsyncResultStatus.Failed)return console.error("Error opening dialog: ".concat(e.error.message)),void i(!1);(o=e.value).addEventHandler(Office.EventType.DialogMessageReceived,(function(e){o.close(),"yes"===e.message?i(!0):i(!1)})),o.addEventHandler(Office.EventType.DialogEventReceived,(function(e){console.log("Dialog event received: "+e.error),i(!1)}))}))}))}function E(e){return!!h.toLowerCase().includes(e)}Office.onReady((function(e){if(e.host===Office.HostType.Excel){f=Office.context.document.url,h=f.substring(f.lastIndexOf("/")+1),d=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1),document.getElementById("openBokSiteButton").addEventListener("click",(function(){Office.context.ui.displayDialogAsync("https://www.bokfinancial.com/business",{height:90,width:80,displayInIframe:!0},(function(e){e.status===Office.AsyncResultStatus.Failed?console.error("Dialog could not be opened: "+e.error.message):((p=e.value).addEventHandler(Office.EventType.DialogMessageReceived,(function(e){console.log("Message received from dialog: "+e.message),p.close()})),p.addEventHandler(Office.EventType.DialogEventReceived,(function(e){console.log("Dialog event received: "+e.error)})))}))})),document.getElementById("openAnbSiteButton").addEventListener("click",(function(){Office.context.ui.displayDialogAsync("https://www.anbbank.com",{height:90,width:80,displayInIframe:!0},(function(e){e.status===Office.AsyncResultStatus.Failed?console.error("Dialog could not be opened: "+e.error.message):((p=e.value).addEventHandler(Office.EventType.DialogMessageReceived,(function(e){console.log("Message received from dialog: "+e.message),p.close()})),p.addEventHandler(Office.EventType.DialogEventReceived,(function(e){console.log("Dialog event received: "+e.error)})))}))}));var n="excelSettings",r={checkFileName:!0};g=function(){var e,t,i=(e=n,(t=Office.context.partitionKey)?localStorage.getItem(t+e):localStorage.getItem(e));if(!i||"null"===i)return r;try{var o=JSON.parse(i);return u(u({},r),o)}catch(e){return console.error("Error parsing stored settings. Falling back to defaults.",e),r}}(),(v=document.getElementById("check-filename-checkbox"))&&(v.checked=g.checkFileName),document.getElementById("save-button").addEventListener("click",(function(){!function(e){try{var t=JSON.stringify(e);r=n,i=t,(o=Office.context.partitionKey)?localStorage.setItem(o+r,i):localStorage.setItem(r,i)}catch(e){console.error("Could not save settings.",e)}var r,i,o}({checkFileName:document.getElementById("check-filename-checkbox").checked})}));var o=document.getElementById("import-bok-csv-button"),s=document.getElementById("import-anb-csv-button"),c=document.getElementById("bok-csv-file-input"),l=document.getElementById("anb-csv-file-input");o.addEventListener("click",a(i().m((function e(){var n,r;return i().w((function(e){for(;;)switch(e.n){case 0:(n=c.files[0])?((r=new FileReader).onload=function(){var e=a(i().m((function e(n){var r,o,s;return i().w((function(e){for(;;)switch(e.n){case 0:if(o=n.target.result,!((r=t().parse(o,{skipEmptyLines:!0,skipFirstNLines:1}).data)&&r.length>0)){e.n=6;break}if(!E("bok")){e.n=1;break}m(r,"bok"),e.n=5;break;case 1:if(s=!1,!document.getElementById("check-filename-checkbox").checked){e.n=3;break}return e.n=2,w("generic",'"BOK" not found in the currently open workbook\'s name. Proceed anyway?',null,"yes-no");case 2:s=e.v,e.n=4;break;case 3:s=!0;case 4:s&&m(r,"bok");case 5:e.n=7;break;case 6:console.error("Could not read data from CSV."),w("generic","Could not parse the CSV. Ensure you are using the CSV from ANB for this tool.");case 7:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.onerror=function(e){console.error("File could not be read! "+e.target.error)},r.readAsText(n)):w("generic","Please select a file.");case 1:return e.a(2)}}),e)})))),s.addEventListener("click",a(i().m((function e(){var n,r;return i().w((function(e){for(;;)switch(e.n){case 0:(n=l.files[0])?((r=new FileReader).onload=function(){var e=a(i().m((function e(n){var r,o,s;return i().w((function(e){for(;;)switch(e.n){case 0:if(o=n.target.result,!((r=t().parse(o,{skipEmptyLines:!0,skipFirstNLines:4}).data)&&r.length>0)){e.n=6;break}if(r.sort((function(e,t){return new Date(e[1])-new Date(t[1])})),!E("anb")){e.n=1;break}m(r,"anb"),e.n=5;break;case 1:if(s=!1,!document.getElementById("check-filename-checkbox").checked){e.n=3;break}return e.n=2,w("generic",'"ANB" not found in the currently opened workbook\'s name. Proceed anyway?',null,"yes-no");case 2:s=e.v,e.n=4;break;case 3:s=!0;case 4:s&&m(r,"anb");case 5:e.n=7;break;case 6:console.error("Could not read data from CSV."),w("generic","Could not parse the CSV. Ensure you are using the CSV from ANB for this tool.");case 7:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.onerror=function(e){console.error("File could not be read! "+e.target.error)},r.readAsText(n)):w("generic","Please select a file.");case 1:return e.a(2)}}),e)}))))}var g,v}))}(),function(){"use strict";new URL(n(55762),n.b)}()}();
//# sourceMappingURL=taskpane.js.map